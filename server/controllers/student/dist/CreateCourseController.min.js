"use strict";var CourseModel=require("../../models/course/courseModel.js"),multer=require("multer"),cloudinary=require("cloudinary").v2,path=require("path"),createCourse=function(r,t){var o,n,s,u,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=r.body,n=o.title,s=o.price,u=o.description,e.next=4,regeneratorRuntime.awrap(CourseModel.create({title:n,price:s,description:u}));case 4:a=e.sent,t.json(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.json(e.t0.message);case 11:case"end":return e.stop()}},null,null,[[0,8]])},uploadVideos=function(r,o){var t,n,s,u,a,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.params.courseId,n=r.body,s=n.title,u=n.videoTitle,e.next=5,regeneratorRuntime.awrap(CourseModel.findById(t));case 5:if(a=e.sent,i=a.section,r.file||r.file.buffer){e.next=9;break}return e.abrupt("return",o.status(400).json({error:"No file provided in the request"}));case 9:cloudinary.uploader.upload_stream({resource_type:"video"},function(r,t){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r)return console.error("Error uploading to Cloudinary:",r),e.abrupt("return",o.status(500).json({error:"Error uploading to Cloudinary"}));e.next=3;break;case 3:return i.push({title:s,videos:[{title:u,url:t.secure_url}]}),e.next=6,regeneratorRuntime.awrap(a.save());case 6:o.status(201).json({message:"Video uploaded successfully",section:a.section});case 7:case"end":return e.stop()}})}).end(r.file.buffer),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error uploading video:",e.t0),o.status(500).json({error:"Error uploading video"});case 16:case"end":return e.stop()}},null,null,[[0,12]])};module.exports={createCourse:createCourse,uploadVideos:uploadVideos};
//# sourceMappingURL=CreateCourseController.min.js.map
