"use strict";var courseModel=require("../../models/course/courseModel"),studentModel=require("../../models/users/studentModel.js"),reviewController=function(r,t){var n,s,a,u,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.params.courseId,s=r.user,a=r.body.review,e.prev=3,e.next=6,regeneratorRuntime.awrap(courseModel.findById(n));case 6:return u=e.sent,e.next=9,regeneratorRuntime.awrap(studentModel.findById({_id:s.id}));case 9:if(o=e.sent,u&&o){e.next=12;break}return e.abrupt("return",t.status(404).json({message:"Course not found"}));case 12:return u.reviews.push({reviewBy:{userId:o._id,review:a}}),e.next=15,regeneratorRuntime.awrap(u.save());case 15:t.status(201).json({message:"Review added successfully"}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),t.status(500).json({message:e.t0.message});case 21:case"end":return e.stop()}},null,null,[[3,18]])},deleteReview=function(r,t){var n,s,a,u,o,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.params,s=n.courseId,a=n.reviewId,e.next=4,regeneratorRuntime.awrap(courseModel.findById(s));case 4:return u=e.sent,o=u.reviews,c=o.map(function(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r._id.toString()===a)return e.next=3,regeneratorRuntime.awrap(r.deleteOne({reviewId:a}));e.next=3;break;case 3:case"end":return e.stop()}})}),e.next=9,regeneratorRuntime.awrap(u.save());case 9:t.json(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t.json(e.t0.message);case 15:case"end":return e.stop()}},null,null,[[0,12]])};module.exports={reviewController:reviewController};
//# sourceMappingURL=reviewController.min.js.map
