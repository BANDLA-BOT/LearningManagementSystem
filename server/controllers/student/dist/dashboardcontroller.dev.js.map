{"version":3,"sources":["dashboardcontroller.js"],"names":["Student","require","courseModel","getProfile","req","res","id","user","console","log","findById","_id","select","student","find","limit","courses","json","message","Profile","editProfile","body","email","firstname","lastname","userId","updateOne","$set","status","Error","enrollCourse","courseId","params","course","enrolled","push","coursesAvailable","isComplete","save","Message","deleteEnroll","$pull","result","nModified","send","EnrollUpdated","error","topRanks","aggregate","$match","$addFields","Count","$size","$filter","input","as","cond","$eq","$sort","$project","students","rankings","markVideoAsComplete","videoArrId","videoId","videosArr","section","video","videos","completed","markAsComplete","trueCount","i","length","findOneAndUpdate","$addToSet","completedCourses","Data","completedList","progressController","totalCourses","filter","coursesPercentage","coursesData","Progress","courseProgress","studentId","populate","Promise","all","map","$unwind","$group","totalVideos","$sum","completedVideos","$cond","completedPercentage","$multiply","$divide","progress","results","query","f","toLowerCase","where","gt","paidCourses","eq","freeCourses","sorting","sort","title","rating","module","exports"],"mappings":"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","sourcesContent":["const Student = require('../../models/users/studentModel.js')\r\nconst courseModel = require('../../models/course/courseModel.js');\r\n\r\n\r\nconst getProfile = async (req, res) => {\r\n  const id = req.user;\r\n  console.log(id);\r\n  try {\r\n    const student = await Student.findById({ _id: id.id }).select(\"-password\");\r\n    const courses = await courseModel.find().limit(61\r\n\r\n    );\r\n    if (!student) {\r\n      return res.json({ message: \"No student found \" });\r\n    }\r\n    if (!courses) {\r\n      return res.json({ message: \"No courses available currently\" });\r\n    }\r\n    res.json({\r\n      message: \"Students Profile\",\r\n      Profile: student,\r\n      courses: courses,\r\n    });\r\n    console.log(student);\r\n  } catch (error) {}\r\n};\r\nconst editProfile = async(req,res)=>{\r\n  try {\r\n    const {email, firstname, lastname} = req.body\r\n    const userId = req.user.id\r\n    console.log(userId)\r\n    const student = await Student.updateOne(\r\n      {_id:userId},\r\n      {$set:{firstname:firstname, lastname:lastname, email:email}}\r\n    );\r\n    res.status(200).json({message:\"Profile updated successfuly\",})\r\n    \r\n  } catch (error) {\r\n    res.status(500).json({message:\"Internal server error\", Error:error.message})\r\n  }\r\n}\r\nconst enrollCourse = async (req, res) => {\r\n  const { courseId } = req.params;\r\n  const userId = req.user;\r\n  const course = await courseModel.findById({ _id: courseId });\r\n  const student = await Student.findById({ _id: userId.id });\r\n  try {\r\n    if (!student) {\r\n      return res.status(400).json({ message: \"Student not found\" });\r\n    }\r\n    if (!course) {\r\n      return res.status(400).json({ message: \"Course not found\" });\r\n    }\r\n    student.enrolled.push({\r\n      coursesAvailable: course._id,\r\n      isComplete: false,\r\n    });\r\n    await student.save();\r\n    res\r\n      .status(200)\r\n      .json({ Message: \"Course enrolled successfuly\", Student: student });\r\n  } catch (error) {\r\n    res\r\n      .status(500)\r\n      .json({ message: \"Internal server error\", Error: error.message });\r\n  }\r\n};\r\n\r\nconst deleteEnroll = async (req, res) => {\r\n  try {\r\n    const userId = req.user;\r\n    const { courseId } = req.params;\r\n    const result = await Student.updateOne(\r\n      { _id: userId.id },\r\n      { $pull: { enrolled: { _id: courseId } } }\r\n    );\r\n    if (result.nModified > 0) {\r\n      res.status(200).send({ message: \"Enrolls Updated\" });\r\n    }\r\n    res.json({ EnrollUpdated: result });\r\n  } catch (error) {\r\n    res.status(500).send({ message: \"Server error\", error });\r\n  }\r\n};\r\nconst topRanks = async (req, res) => {\r\n  try {\r\n    const students = await Student.aggregate([\r\n      {\r\n        $match: {\r\n          \"enrolled.isComplete\": true,\r\n        },\r\n      },\r\n      {\r\n        $addFields: {\r\n          Count: {\r\n            $size: {\r\n              $filter: {\r\n                input: \"$enrolled\",\r\n                as: \"enrolled\",\r\n                cond: { $eq: [\"$$enrolled.isComplete\", true] },\r\n              },\r\n            },\r\n          },\r\n        },\r\n      },\r\n      {\r\n        $sort: { _id: -1 },\r\n      },\r\n\r\n      {\r\n        $project: {\r\n          firstname: 1,\r\n          lastname: 1,\r\n          Count:1\r\n        },\r\n      },\r\n    ]);\r\n    res.status(200).json({ rankings: students });\r\n  } catch (error) {\r\n    res.status(500).json({ message: \"Internal server error\" });\r\n  }\r\n};\r\n\r\nconst markVideoAsComplete = async(req,res)=>{\r\n  try {\r\n     const {courseId, videoArrId, videoId} = req.params\r\n     const course = await courseModel.findById(courseId)\r\n     if(!course){\r\n      return res.status(404).json({message:\"Course not found\"})\r\n     }\r\n     const videosArr = course.section.id(videoArrId)\r\n     const video = videosArr.videos.id(videoId)\r\n     video.completed = true\r\n     await course.save()\r\n     if(video.completed){\r\n       return res.json({message:\"You have completed the video, move to next\"})\r\n      }\r\n    //  res.json(video)\r\n  } catch (error) {\r\n    res.status(500).json({message:\"Internal server error\", Error:error.message})\r\n  }\r\n}\r\n\r\nconst markAsComplete = async (req, res) => {\r\n  try {\r\n    const { courseId } = req.params;\r\n    const userId = req.user;\r\n    const course = await courseModel.findById(courseId)\r\n    const videosArr = course.section\r\n    const videos = videosArr[0].videos\r\n    let trueCount = 0;\r\n    for(let i=0; i<=videos.length; i++){\r\n      if(videos[i].completed){\r\n          trueCount++\r\n          console.log(videos[i])\r\n          if(videos.length === trueCount){\r\n            const student = await Student.findOneAndUpdate(\r\n              { _id: userId.id, \"enrolled.coursesAvailable\": courseId },\r\n              {\r\n                $set: { \"enrolled.$.isComplete\": true },\r\n                $addToSet: { completedCourses: { courses: courseId } },\r\n              },\r\n              { new: true }\r\n            );\r\n            return res.json({message:\"Successfully completed Course\", Data:student})\r\n          }\r\n      }\r\n      else{\r\n        return res.json({message:\"You have to complete all the videos\"})\r\n      }\r\n    }\r\n  } catch (error) {\r\n    res.json({ message: error.message });\r\n  }\r\n};\r\n\r\nconst completedCourses = async(req,res)=>{\r\n  try {\r\n    const userId = req.user\r\n    const completedList = await Student.findById(userId.id)\r\n    res.json(completedList.completedCourses)\r\n  } catch (error) {\r\n    res.status(500).json({message:\"Internal server error\", error:error.message})\r\n  }\r\n}\r\nconst progressController = async (req, res) => {\r\n  try {\r\n    const userId = req.user.id;\r\n    const student = await Student.findById(userId);\r\n    if (!student) {\r\n      return res.status(404).json({ message: \"Student not found\" });\r\n    }\r\n\r\n    const totalCourses = student.enrolled.length;\r\n    const completedCourses = student.enrolled.filter(\r\n      (course) => course.isComplete\r\n    ).length;\r\n    const coursesPercentage = (completedCourses / totalCourses) * 100;\r\n\r\n    const coursesData = {\r\n      totalCourses,\r\n      completedCourses,\r\n      coursesPercentage,\r\n    };\r\n\r\n    res.status(200).json({ message: \"Progress report\", Progress: coursesData });\r\n  } catch (error) {\r\n    res.json({ message: error.message });\r\n  }\r\n};\r\n\r\nconst courseProgress = async (req, res) => {\r\n  try {\r\n    const studentId = req.user.id;\r\n    const student = await Student.findById(studentId).populate(\"enrolled\");\r\n    if (!student) {\r\n      return res.status(404).json({ message: \"Student not found\" });\r\n    }\r\n    const results = await Promise.all(\r\n        student.enrolled.map(async (course) => {\r\n        const result = await courseModel.aggregate([\r\n          { $match: { _id: course.coursesAvailable } },\r\n          { $unwind: \"$section\" },\r\n          { $unwind: \"$section.videos\" },\r\n          {\r\n            $group: {\r\n              _id: null,\r\n              totalVideos: { $sum: 1 },\r\n              completedVideos: {\r\n                $sum: { $cond: [\"$section.videos.completed\", 1, 0] },\r\n              },\r\n            },\r\n          },\r\n          {\r\n            $project: {\r\n              _id: 0,\r\n              totalVideos: 1,\r\n              completedVideos: 1,\r\n              completedPercentage: {\r\n                $cond: [\r\n                    { $eq: ['$totalVideos', 0] },\r\n                    0,\r\n                    { \r\n                      $multiply: [\r\n                        { $divide: ['$completedVideos', '$totalVideos'] },\r\n                        100\r\n                      ]\r\n                    }\r\n                  ]\r\n              },\r\n            },\r\n          },\r\n        ]);\r\n        return {\r\n            course:course,\r\n            progress:result[0]\r\n        }\r\n      })\r\n    )\r\n    res.json(results)\r\n  } catch (error) {\r\n    res\r\n      .status(500)\r\n      .json({ message: \"Internal server error\", error: error.message });\r\n  }\r\n};\r\n\r\n\r\n//filtering Records \r\n\r\nconst filter = async(req,res)=>{\r\n  try {\r\n    const query = req.query.f\r\n    console.log(query)\r\n    if(query.toLowerCase() === 'paid'){\r\n      const paidCourses = await courseModel.find().where('price').gt(0);\r\n      return res.status(200).json({message:\"Paid courses\", paidCourses:paidCourses})\r\n    }else if(query.toLowerCase() === 'free'){\r\n      const freeCourses = await courseModel.find().where('price').eq(0)\r\n      return res.status(200).json({message:\"free courses\", freeCourses:freeCourses})\r\n    }\r\n    res.json({message:\"No courses available based on Query\"})\r\n  } catch (error) {\r\n    res.status(500).json({message:\"Internal server error\", Error:error.message})\r\n  }\r\n}\r\n\r\nconst sorting = async(req,res)=>{\r\n  try {\r\n    const query = req.query.sort\r\n    if(query.toLowerCase() === \"asc\"){\r\n      const courses = await courseModel.find().sort({title:1})\r\n      return res.json({message:\"Ascending order\", course:courses})\r\n    }\r\n    else if(query.toLowerCase() === \"desc\"){\r\n      const courses = await courseModel.find().sort({title:-1})\r\n      return res.json({message:\"Descending order\", course:courses})\r\n    }\r\n    else if(query.toLowerCase() === \"rating\"){\r\n      const courses = await courseModel.find().sort({rating:-1})\r\n      return res.json({message:\"Rating order\", course:courses})\r\n    }\r\n    res.json({message:\"No Sorting chosen\"})\r\n  } catch (error) {\r\n    res.status(500).json({message:\"Internal server error\", Error:error.message})\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  getProfile,\r\n  enrollCourse,\r\n  deleteEnroll,\r\n  topRanks,\r\n  markAsComplete,\r\n  completedCourses,\r\n  progressController,\r\n  courseProgress,\r\n  filter,\r\n  sorting,\r\n  markVideoAsComplete,\r\n  editProfile\r\n};\r\n"],"file":"dashboardcontroller.dev.js"}