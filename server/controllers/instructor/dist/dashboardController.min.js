"use strict";var Instructor=require("../../models/users/instructorModel.js"),CourseModel=require("../../models/course/courseModel.js"),bcrypt=require("bcryptjs"),mentorsController=function(r,t){var s,n,a,o,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.user.id,e.next=4,regeneratorRuntime.awrap(Instructor.find());case 4:return n=e.sent,e.next=7,regeneratorRuntime.awrap(CourseModel.find());case 7:a=e.sent,o=a.map(function(e){return e.price?[e.title,e.description,e.price]:e.price<=0?[e.title,e.description,"FREE"]:void 0}),u={},n.map(function(e){e._id.toString()===s&&(u=e)}),t.status(200).json({message:"Data found",mentors:n,profile:u,CoursesList:o}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),t.status(500).json({message:"Internal server error",Error:e.t0.message});case 17:case"end":return e.stop()}},null,null,[[0,14]])},editInstructorProfile=function(r,t){var s,n,a,o,u,c,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.user.id,n=r.body,a=n.firstname,o=n.lastname,u=n.about,c="".concat(r.file.destination,"/").concat(r.file.filename),e.next=6,regeneratorRuntime.awrap(Instructor.findOne({_id:s}));case 6:return(i=e.sent).about=u,i.firstname=a,i.lastname=o,i.profilePic=c,e.next=13,regeneratorRuntime.awrap(i.save());case 13:t.json(i),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),t.status(500).json({message:"Internal server error",Error:e.t0.message});case 19:case"end":return e.stop()}},null,null,[[0,16]])},editPassword=function(r,t){var s,n,a,o,u,c,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.user.id,n=r.body,a=n.currentPassword,o=n.newPassword,u=n.confirmPassword,e.next=5,regeneratorRuntime.awrap(Instructor.findById(s));case 5:if(c=e.sent,bcrypt.compareSync(a,c.password)){e.next=9;break}return e.abrupt("return",t.status(400).json({message:"Incorrect current password"}));case 9:if(a===o)return e.abrupt("return",t.status(400).json({message:"New password should be different than old password"}));e.next=11;break;case 11:if(o!==u)return e.abrupt("return",t.status(400).json({message:"Passwords did not match"}));e.next=13;break;case 13:return i=bcrypt.hashSync(o,10),c.password=i,e.next=17,regeneratorRuntime.awrap(c.save());case 17:t.status(200).json({message:"Password changed successfully",User:c}),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(0);case 22:case"end":return e.stop()}},null,null,[[0,20]])};module.exports={mentorsController:mentorsController,editInstructorProfile:editInstructorProfile,editPassword:editPassword};
//# sourceMappingURL=dashboardController.min.js.map
